{"version":3,"sources":["Menu.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["const {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Menu extends cc.Component {\r\n\r\n    @property({type:cc.AudioClip})\r\n    bgm: cc.AudioClip = null;\r\n\r\n    start () {\r\n        this.initButton();\r\n        this.initBoard();\r\n        cc.audioEngine.stopAll();\r\n        cc.audioEngine.play(this.bgm, true, 0.5);\r\n    }\r\n\r\n    initButton() { \r\n        let clickEventHandler_easy = new cc.Component.EventHandler(); \r\n        clickEventHandler_easy.target = this.node;\r\n        clickEventHandler_easy.handler = \"loadEasyScene\";\r\n        clickEventHandler_easy.component = \"Menu\";\r\n        cc.find(\"Canvas/UI/easyButton\").getComponent(cc.Button).clickEvents.push(clickEventHandler_easy);\r\n\r\n        let clickEventHandler_normal = new cc.Component.EventHandler(); \r\n        clickEventHandler_normal.target = this.node;\r\n        clickEventHandler_normal.handler = \"loadNormalScene\";\r\n        clickEventHandler_normal.component = \"Menu\";\r\n        cc.find(\"Canvas/UI/normalButton\").getComponent(cc.Button).clickEvents.push(clickEventHandler_normal);\r\n    } \r\n\r\n    loadEasyScene(){\r\n        cc.director.loadScene(\"start_easy\"); \r\n    }\r\n\r\n    loadNormalScene(){\r\n        cc.director.loadScene(\"start_normal\"); \r\n    }\r\n\r\n    initBoard() {\r\n        firebase.auth().onAuthStateChanged(function(user) {\r\n            if (user) {\r\n                cc.find(\"Canvas/Misc/board/user/name\").getComponent(cc.Label).string = user.email.split('@')[0].toUpperCase();\r\n                var cleanEmail = user.email.replace(/\\./g, ',');\r\n                firebase.database().ref(cleanEmail).once('value', function(snapshot) {\r\n                    if (snapshot.exists()) {\r\n                        //cc.log(\"不是第一次登\");\r\n                        var childData = snapshot.val();\r\n                        cc.find(\"Canvas/Misc/board/life/val\").getComponent(cc.Label).string = childData.life;\r\n                        cc.find(\"Canvas/Misc/board/coin/val\").getComponent(cc.Label).string = childData.coin;\r\n                        cc.find(\"Canvas/Misc/board/score/val\").getComponent(cc.Label).string = childData.score;\r\n                    }\r\n                    else{\r\n                        //cc.log(\"第一次登\");\r\n                        firebase.database().ref(cleanEmail).set({\r\n                            score: 0,\r\n                            coin: 0,\r\n                            life: 5\r\n                        });\r\n                        cc.find(\"Canvas/Misc/board/life/val\").getComponent(cc.Label).string = '5';\r\n                        cc.find(\"Canvas/Misc/board/coin/val\").getComponent(cc.Label).string = '0';\r\n                        cc.find(\"Canvas/Misc/board/score/val\").getComponent(cc.Label).string = '0';\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                alert('Please Login First!');\r\n            }\r\n        });\r\n    }\r\n}\r\n"]}