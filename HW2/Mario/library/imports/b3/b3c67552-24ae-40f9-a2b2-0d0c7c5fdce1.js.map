{"version":3,"sources":["..\\..\\..\\..\\assets\\Scripts/assets\\Scripts\\Turtle.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["import Player from \"./Player\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n    @property(Player)\r\n    player: Player = null;\r\n\r\n    @property()\r\n    turtleSpeed: number = 150;\r\n\r\n    @property({type:cc.AudioClip})\r\n    kickSound: cc.AudioClip = null;\r\n\r\n    @property({type:cc.AudioClip})\r\n    stompSound: cc.AudioClip = null;\r\n\r\n    private anim: cc.Animation = null;\r\n    private moveDir = -1;\r\n    private mode = 0;   //0: walk, 1: shell, 2: slide\r\n\r\n    start () {\r\n        this.anim = this.getComponent(cc.Animation);\r\n    }\r\n\r\n    update (dt) {\r\n        if(this.moveDir == 1) {\r\n            this.node.scaleX = -2.5;\r\n        }\r\n        else if(this.moveDir == -1) {\r\n            this.node.scaleX = 2.5;\r\n        }\r\n        this.node.scaleY = 2.5;\r\n        this.node.x += this.turtleSpeed * this.moveDir * dt;\r\n\r\n    }\r\n    \r\n    onBeginContact(contact, self, other) {\r\n        if(other.node.name == \"lowBound\"){\r\n            this.node.destroy();\r\n            cc.log(\"turtle destroy!\");\r\n        }\r\n        else if(other.node.name == \"player\"){\r\n            if(this.player.getSuper()){\r\n                contact.disabled = true;\r\n            }\r\n            else if(contact.getWorldManifold().normal.y <= 0 && this.mode == 0) {\r\n                other.getComponent(Player).changeMode(0);\r\n            }\r\n            else if(contact.getWorldManifold().normal.y > 0 && this.mode == 0) {\r\n                cc.audioEngine.playEffect(this.stompSound, false);\r\n                this.player.enemyJump();\r\n                this.moveDir = 0;\r\n                this.mode = 1;\r\n                if(!this.anim.getAnimationState(\"turtle_shell\").isPlaying){\r\n                    this.anim.play(\"turtle_shell\");\r\n                }\r\n\r\n                firebase.auth().onAuthStateChanged((user) => {\r\n                    var cleanEmail = user.email.replace(/\\./g, ',');\r\n                    firebase.database().ref(cleanEmail).once('value', (snapshot) => {\r\n                        var childData = snapshot.val();\r\n                        cc.find(\"Canvas/Main Camera/Board/score\").getComponent(cc.Label).string = childData.score+100;\r\n                        firebase.database().ref(cleanEmail).set({\r\n                            life: childData.life,\r\n                            coin: childData.coin,\r\n                            score: childData.score+100\r\n                        });\r\n                    });\r\n                });\r\n            }\r\n            else if(this.mode == 1){\r\n                cc.audioEngine.playEffect(this.kickSound, false);\r\n                if(contact.getWorldManifold().normal.y > 0) this.player.enemyJump();\r\n                this.player.playerSuper();\r\n                if(!this.anim.getAnimationState(\"turtle_slide\").isPlaying) {\r\n                    this.anim.play(\"turtle_slide\");\r\n                }   \r\n                if(other.getComponent(Player).node.scaleX > 0) {\r\n                    this.moveDir = 1;\r\n                }\r\n                else {\r\n                    this.moveDir = -1;\r\n                }\r\n                this.mode = 2;\r\n                this.node.group = \"shell\";\r\n                this.getComponent(cc.PhysicsBoxCollider).apply();\r\n            }\r\n            else if(this.mode == 2){\r\n                other.getComponent(Player).changeMode(0);\r\n            }\r\n        }\r\n        else if(contact.getWorldManifold().normal.y == 0){\r\n            if(this.moveDir == 1) this.moveDir = -1;\r\n            else if(this.moveDir == -1) this.moveDir = 1;\r\n        }\r\n    }\r\n}\r\n"]}