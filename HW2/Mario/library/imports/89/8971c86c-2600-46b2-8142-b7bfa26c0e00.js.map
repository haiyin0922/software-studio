{"version":3,"sources":["..\\..\\..\\..\\assets\\Scripts/assets\\Scripts\\Mushroom.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["import Player from \"./Player\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Mushroom extends cc.Component {\r\n\r\n    @property(Player)\r\n    player: Player = null;\r\n\r\n    @property()\r\n    mushroomSpeed: number = 200;\r\n\r\n    @property({type:cc.AudioClip})\r\n    moveupSound: cc.AudioClip = null;\r\n\r\n    private moveDir = 1;\r\n    private cnt = 0;\r\n\r\n    update (dt) {\r\n        if(this.cnt > 0 && this.cnt < 35) {\r\n            this.node.y += 1;\r\n            this.cnt += 1;\r\n        }\r\n        if(this.cnt == 35) {\r\n            this.getComponent(cc.PhysicsBoxCollider).enabled = true;\r\n            this.getComponent(cc.RigidBody).gravityScale = 1;\r\n            this.node.x += this.mushroomSpeed * this.moveDir * dt;\r\n        }\r\n    }\r\n\r\n    start () { \r\n        this.getComponent(cc.PhysicsBoxCollider).enabled = false;\r\n    }\r\n\r\n    onBeginContact(contact, self, other) {\r\n        if(other.node.name == \"lowBound\"){\r\n            this.node.destroy();\r\n            cc.log(\"mushroom destroy!\");\r\n        }\r\n        else if(other.node.name == \"player\"){\r\n            if(this.player.getSuper()){\r\n                contact.disabled = true;\r\n            }\r\n            else{\r\n                this.node.destroy();\r\n                other.getComponent(Player).changeMode(1);\r\n                cc.log(\"mushroom destroy!\");\r\n\r\n                firebase.auth().onAuthStateChanged((user) => {\r\n                    var cleanEmail = user.email.replace(/\\./g, ',');\r\n                    firebase.database().ref(cleanEmail).once('value', (snapshot) => {\r\n                        var childData = snapshot.val();\r\n                        cc.find(\"Canvas/Main Camera/Board/score\").getComponent(cc.Label).string = childData.score+1000;\r\n                        firebase.database().ref(cleanEmail).set({\r\n                            life: childData.life,\r\n                            coin: childData.coin,\r\n                            score: childData.score+1000\r\n                        });\r\n                    });\r\n                });\r\n            }\r\n        }\r\n        else if(contact.getWorldManifold().normal.y == 0){\r\n            if(this.moveDir == 1) this.moveDir = -1;\r\n            else if(this.moveDir == -1) this.moveDir = 1;\r\n        }\r\n\r\n    }\r\n    \r\n    moveUp() {\r\n        cc.audioEngine.playEffect(this.moveupSound, false);\r\n        this.cnt = 1;\r\n    }\r\n\r\n}\r\n"]}