{"version":3,"sources":["Menu.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["const {ccclass, property} = cc._decorator;\r\n@ccclass\r\nexport default class Menu extends cc.Component {\r\n    @property({type:cc.AudioClip})\r\n    soundBgm: cc.AudioClip = null;\r\n    \r\n    rankNode: cc.Node;\r\n\r\n    onLoad() {\r\n        this.rankNode = cc.find(\"Canvas/Misc/Rank\");\r\n    }\r\n    start () {\r\n        this.initButton();\r\n        this.initBoard();\r\n        this.rankNode.active = false;\r\n        cc.audioEngine.stopAll();\r\n        //cc.audioEngine.play(this.bgm, true, 0.5);\r\n        cc.audioEngine.setMusicVolume(0.4);\r\n        cc.audioEngine.playMusic(this.soundBgm, true);\r\n    }\r\n    initButton() { \r\n        let clickEventHandler = new cc.Component.EventHandler(); \r\n        clickEventHandler.target = this.node;\r\n        clickEventHandler.handler = \"loadGameScene\";\r\n        clickEventHandler.component = \"Menu\";\r\n        cc.find(\"Canvas/UI/Button\").getComponent(cc.Button).clickEvents.push(clickEventHandler);\r\n        let clickEventHandler_rank = new cc.Component.EventHandler(); \r\n        clickEventHandler_rank.target = this.node;\r\n        clickEventHandler_rank.handler = \"showRank\";\r\n        clickEventHandler_rank.component = \"Menu\";\r\n        cc.find(\"Canvas/Misc/Rank Button\").getComponent(cc.Button).clickEvents.push(clickEventHandler_rank);\r\n    } \r\n    showRank(){\r\n        cc.log(\"GGG\");\r\n        this.rankNode.active = !this.rankNode.active;\r\n    }\r\n    loadGameScene(){\r\n        firebase.auth().onAuthStateChanged((user) => {\r\n            if (user) {\r\n                var cleanEmail = user.email.replace(/\\./g, ',');\r\n                firebase.database().ref(cleanEmail).once('value', (snapshot) => {\r\n                    var childData = snapshot.val();\r\n                    if(childData.x != 'X'){\r\n                        cc.director.loadScene(\"Game\");\r\n                    }\r\n                    else{\r\n                        cc.director.loadScene(\"StartGame\");\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n    initBoard() {\r\n        firebase.database().ref('rank').once('value', function(snapshot) {\r\n            if (snapshot.exists()) {\r\n                var childData = snapshot.val();\r\n                cc.find(\"Canvas/Misc/Rank/NO1/Name\").getComponent(cc.Label).string = childData.one;\r\n                cc.find(\"Canvas/Misc/Rank/NO2/Name\").getComponent(cc.Label).string = childData.two;\r\n                cc.find(\"Canvas/Misc/Rank/NO3/Name\").getComponent(cc.Label).string = childData.three;\r\n                cc.find(\"Canvas/Misc/Rank/NO1/Val\").getComponent(cc.Label).string = childData.oneval;\r\n                cc.find(\"Canvas/Misc/Rank/NO2/Val\").getComponent(cc.Label).string = childData.twoval;\r\n                cc.find(\"Canvas/Misc/Rank/NO3/Val\").getComponent(cc.Label).string = childData.threeval;\r\n            }\r\n        });\r\n        firebase.auth().onAuthStateChanged(function(user) {\r\n            if (user) {\r\n                cc.find(\"Canvas/Misc/User/Name\").getComponent(cc.Label).string = user.email.split('@')[0].toUpperCase();\r\n                var cleanEmail = user.email.replace(/\\./g, ',');\r\n                firebase.database().ref(cleanEmail).once('value', function(snapshot) {\r\n                    if (snapshot.exists()) {\r\n                        //cc.log(\"不是第一次登\");\r\n                        var childData = snapshot.val();\r\n                        cc.find(\"Canvas/Misc/Highest/Val\").getComponent(cc.Label).string = childData.time;\r\n                    }\r\n                    else{\r\n                        //cc.log(\"第一次登\");\r\n                        firebase.database().ref(cleanEmail).set({\r\n                            time: 'X',\r\n                            savetime: 'X',\r\n                            x: 'X',\r\n                            y: 'X'\r\n                        });\r\n                        cc.find(\"Canvas/Misc/Highest/Val\").getComponent(cc.Label).string = 'X';\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                alert('Please Login First!');\r\n            }\r\n        });\r\n    }\r\n}"]}